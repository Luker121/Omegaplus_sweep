# Selective sweep analysis in *Arabis nemorensis* and *Arabis sagittata*

This repository contains scripts, data files, and plots related to the identification of selective sweeps in *Arabis nemorensis* and *Arabis sagittata*. The analysis involves simulating demographic histories, detecting selective sweeps using OmegaPlus, and investigating the overlap between sweep regions and quantitative trait loci (QTLs).

## Files and descriptions

### scripts/

#### `Arabis_divergent_model_singlepop_ancAndrecentMigration.slim`

This SLiM script simulates the demographic history of *Arabis nemorensis* and *Arabis sagittata*, incorporating both ancient and recent gene flow events. 
The simulation is based on the demographic history inferred by Dittberner et al. (2022) and includes:

- Two pulses of interspecific gene flow between the species:
  - An ancient pulse directly after the species split.
  - A recent migration event between sympatric populations.
- Generation of 10,000 neutral datasets of 2 Mb each.
- Assumption of a fixed recombination rate for each simulated block (5.5e-8).

The simulated data are used to establish the 99th percentile cut-off values for the omega statistics to minimize false positives due to demographic processes.

#### `run_OmegaPlus_treesfile_simulatedData.py`

This Python script runs OmegaPlus on simulated data generated by the SLiM script. It:

- Reads tree files from the simulated datasets.
- Runs OmegaPlus with specified parameters.
- Outputs omega statistics for each simulated dataset.

Calculates omega statistics for simulated data to build a distribution for threshold determination.

#### `plot_and_determine_threshold_omegaplus_simulated_data.py`

This script uses all OmegaPlus output files of the simulated data and plots a distribution in order to extract the 99th percentile for threshold determination.

#### `run_OmegaPlus_vcf_files_realData.py`

This Python script runs OmegaPlus on the Arabis data. It:

- Reads filtered VCF files.
- Runs OmegaPlus with specified parameters.
- Identifies selective sweep regions in the real dataset.

#### `read_OmegaPlus_vcf_files.py`

This Python script processes the output files from the analysis with OmegaPlus. 

### sweep_data_files/

This directory contains the processed output data files from OmegaPlus of *Arabis nemorensis* and *Arabis sagittata* to further investigate overlap with QTLs.

### plots/

#### `plot_overlap_QTLs_sweeps.R`

This R script visualizes the overlap between selective sweep regions identified by OmegaPlus and QTLs in *Arabis nemorensis* and *Arabis sagittata* using the output files of OmegaPlus.
